<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Mynd ‚Ä¢ Multilayer Framework (Garden Curriculum)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
<style>
  /* =================== TOKENS =================== */
  :root{
    --ink:#1f2933; --muted:#6b7280;
    --paper:#f7f5f0; --earth:#eeebe4;
    --wrap:min(1160px,92vw);
    --radius:22px; --radius-lg:26px; --chip:999px;
    --shadow:0 14px 40px rgba(0,0,0,.12);
    --shadow-soft:0 10px 28px rgba(0,0,0,.08);
    --shadow-hover:0 16px 50px rgba(0,0,0,.14);

    /* World palettes */
    --garden-1:#7fb68b; --garden-2:#2e5e4e; --garden-wash:rgba(127,182,139,.14);
    --city-1:#6b93c7;   --city-2:#1f4f86;   --city-wash:rgba(107,147,199,.14);
    --forge-1:#ef7d56;  --forge-2:#a33b21;  --forge-wash:rgba(239,125,86,.14);
    --system-1:#66d0d0; --system-2:#1f8f8f; --system-wash:rgba(102,208,208,.14);

    /* Category color system (soft backgrounds + headers) */
    --cat-lesson-bg:#ffffff;  --cat-lesson-h:#2b3a33;
    --cat-practice-bg:#e9f5ee;--cat-practice-h:#275a46;
    --cat-reflect-bg:#edf3fb; --cat-reflect-h:#1f4f86;
    --cat-mantra-bg:#fff7e6;  --cat-mantra-h:#8a5a00;
    --cat-science-bg:#f3ecff; --cat-science-h:#5d3aa1;
    --cat-story-bg:#fff0f4;   --cat-story-h:#a33359;
    --cat-note-bg:#f4f4f4;    --cat-note-h:#3a3a3a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  html{scroll-behavior:smooth}
  body{
    margin:0; color:var(--ink);
    font:400 16px/1.6 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background:
      radial-gradient(1200px 560px at 10% -10%, rgba(191,214,242,.45), transparent 58%),
      radial-gradient(900px 420px at 90% -6%, rgba(106,143,107,.30), transparent 60%),
      linear-gradient(180deg, #f8f6f1 0%, var(--earth) 38%, #ebe7de 100%);
    -webkit-text-size-adjust:100%; text-size-adjust:100%;
  }
  body::before{
    content:""; position:fixed; inset:0; pointer-events:none; z-index:-1; opacity:.25;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3CfeColorMatrix values='0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 .02 0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  }
  .container{width:var(--wrap);margin-inline:auto}
  .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(0,0,0,.08),transparent);margin:26px 0}

  /* ============== HEADER ============== */
  header{position:sticky;top:0;z-index:60;backdrop-filter:blur(10px) saturate(140%);
    background:rgba(248,246,241,.7); border-bottom:1px solid rgba(0,0,0,.06)}
  .header-inner{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
  .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit}
  .logo{width:32px;height:32px;border-radius:10px;display:grid;place-items:center;
    background:linear-gradient(160deg,#bbd7f5,#6e8f6b);color:#0d1b10;font-weight:800;
    font-family:"Playfair Display",serif; box-shadow:var(--shadow-soft)}
  nav{display:flex;gap:16px;align-items:center}
  nav a{color:#2c2c2c;text-decoration:none;font-weight:700;opacity:.9;white-space:nowrap;padding:8px 10px;border-radius:12px}
  nav a.active, nav a:hover{background:rgba(0,0,0,.06);opacity:1}
  .cta{background:linear-gradient(180deg,#7FB68B,#5B8E6B);color:#0f1f14;border:none;border-radius:999px;
    padding:10px 14px;font-weight:800;letter-spacing:.2px;cursor:pointer;box-shadow:var(--shadow-soft)}
  .menu-btn{display:none;border:0;background:transparent;padding:6px;margin-left:8px}
  .menu-btn svg{width:26px;height:26px}
  .mobile-sheet{display:none;position:fixed;inset:0;background:rgba(0,0,0,.25);z-index:70}
  .mobile-panel{position:absolute;right:0;top:0;height:100%;width:78%;max-width:360px;background:#fff;border-left:1px solid rgba(0,0,0,.08);
    box-shadow:var(--shadow);padding:18px 16px;display:flex;flex-direction:column;gap:12px}
  .mobile-panel a{padding:10px 12px;border-radius:12px;background:#f7f6f2;text-decoration:none;color:#222;font-weight:800}
  .mobile-close{align-self:flex-end;border:0;background:#f0efe9;border-radius:10px;padding:8px}
  @media (max-width:860px){
    nav, .cta{display:none}
    .menu-btn{display:block}
    .container{width:100%;max-width:100%;padding-inline:clamp(14px,4vw,22px)}
  }

  /* ============== HERO ============== */
  .title{font-family:"Playfair Display",serif;font-size:clamp(28px,5.1vw,52px);line-height:1.04;margin:18px 0 8px;color:#1e2d24}
  .lead{max-width:780px;font-size:clamp(15px,2.4vw,18px);opacity:.95;margin:0 0 10px}

  /* ============== LENS PICKER ============== */
  .lens{display:flex;gap:10px;flex-wrap:wrap;margin:16px 0 6px}
  .chip{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:var(--chip);
    border:1px solid rgba(0,0,0,.08);background:#fff;font-weight:800;text-decoration:none;color:#1f2420;cursor:pointer}
  .chip[data-world="garden"]{box-shadow:0 8px 22px rgba(0,0,0,.1);background:linear-gradient(180deg,var(--garden-1),var(--garden-2));color:#0e1c14}
  .chip[data-world="city"]{box-shadow:0 8px 22px rgba(0,0,0,.1);background:linear-gradient(180deg,var(--city-1),var(--city-2));color:#0e1520}
  .chip[data-world="forge"]{box-shadow:0 8px 22px rgba(0,0,0,.1);background:linear-gradient(180deg,var(--forge-1),var(--forge-2));color:#200e0a}
  .chip[data-world="system"]{box-shadow:0 8px 22px rgba(0,0,0,.1);background:linear-gradient(180deg,var(--system-1),var(--system-2));color:#041b1b}
  .chip small{opacity:.9;font-weight:800}
  .save{display:inline-flex;align-items:center;justify-content:center;padding:11px 16px;border-radius:999px;border:0;
    background:rgba(0,0,0,.06);font-weight:800;cursor:pointer}
  .save:hover{background:rgba(0,0,0,.1)}

  /* ============== CARDS + PANELS ============== */
  .worlds{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-top:12px}
  @media (max-width:1000px){.worlds{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:560px){.worlds{grid-template-columns:1fr}}
  .card{border-radius:20px;border:1px solid rgba(0,0,0,.08);background:#fff;box-shadow:var(--shadow-soft);padding:16px}
  .card h3{margin:0 0 8px}
  .tag{display:inline-block;font-size:12px;font-weight:800;letter-spacing:.2px;padding:4px 8px;border-radius:999px;background:#f0efe9;color:#334}
  .wash{border-radius:16px;padding:12px;margin:10px 0;border:1px solid rgba(0,0,0,.06);background:#fff}
  .wash.garden{background:linear-gradient(180deg,var(--garden-wash),#fff)}
  .wash.city{background:linear-gradient(180deg,var(--city-wash),#fff)}
  .wash.forge{background:linear-gradient(180deg,var(--forge-wash),#fff)}
  .wash.system{background:linear-gradient(180deg,var(--system-wash),#fff)}
  .panel{background:rgba(255,255,255,.86);border:1px solid rgba(0,0,0,.06);border-radius:22px;box-shadow:var(--shadow);padding:18px}
  .section{padding:10px 0}
  .grid{display:grid;gap:18px;grid-template-columns: 1.1fr .9fr}
  @media (max-width:980px){.grid{grid-template-columns:1fr}}
  .block{border-radius:18px;padding:16px;border:1px solid rgba(0,0,0,.06);background:#fff}
  .block h4{margin:0 0 8px}

  /* Tables */
  .table{width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden}
  .table thead th{background:#f6f6f6;padding:10px 12px;text-align:left;font-size:14px;border-bottom:1px solid rgba(0,0,0,.06)}
  .table tbody td{padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.06);vertical-align:top}
  .table tbody tr:last-child td{border-bottom:none}

  /* Curriculum module layout */
  .module{scroll-margin-top:90px}
  .module-header{display:flex;align-items:center;justify-content:space-between;gap:10px}
  .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:800;border:1px solid rgba(0,0,0,.08);background:#fff}
  .kid{font-size:14px;background:#fffbe8;border:1px solid rgba(0,0,0,.06);border-radius:12px;padding:10px}
  .mantra{background:var(--cat-mantra-bg);border:1px solid rgba(0,0,0,.06);border-radius:12px;padding:10px}

  /* Inputs */
  .journal{display:grid;gap:10px}
  textarea{width:100%;min-height:120px;padding:12px 14px;border-radius:12px;border:1px solid rgba(0,0,0,.12);font:inherit}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 18px;border-radius:999px;border:0;font-weight:800;cursor:pointer}
  .btn.primary{background:#fff;border:1px solid rgba(0,0,0,.1);box-shadow:var(--shadow-soft)}
  .btn.save{background:linear-gradient(180deg,#bbd7f5,#7fb68b)}
  .full-mobile{display:inline-flex}
  @media (max-width:560px){.full-mobile{width:100%}}

  /* Footer */
  footer{padding:36px 0 72px;border-top:1px solid rgba(0,0,0,.06);background:rgba(255,255,255,.6)}
  .footer-inner{display:flex;align-items:center;justify-content:space-between;gap:18px;flex-wrap:wrap}
  .tiny{font-size:12px;opacity:.7}
</style>
</head>
<body>
<header>
  <div class="container header-inner">
    <a class="brand" href="index.html" aria-label="Mynd home"><div class="logo">My</div><span>Mynd</span></a>
    <nav aria-label="Primary">
      <a href="garden.html" class="active">Garden</a>
      <a href="tree.html">Tree</a>
      <a href="greenhouse.html">Greenhouse</a>
      <a href="vision.html">Vision</a>
      <a href="about.html">About</a>
    </nav>
    <button class="menu-btn" aria-label="Open menu">
      <svg viewBox="0 0 24 24" fill="none" stroke="#2b3a33" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
    </button>
    <a class="cta" href="vision.html">Support the Vision</a>
  </div>

  <!-- Mobile sheet -->
  <div class="mobile-sheet" id="sheet" aria-hidden="true">
    <div class="mobile-panel" role="dialog" aria-modal="true" aria-label="Navigation">
      <button class="mobile-close" id="closeSheet" aria-label="Close menu">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#2b3a33" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18M6 6l12 12"/></svg>
      </button>
      <a href="garden.html" class="active">Garden</a>
      <a href="tree.html">Tree</a>
      <a href="greenhouse.html">Greenhouse</a>
      <a href="vision.html">Vision</a>
      <a href="about.html">About</a>
      <a class="cta" href="vision.html" style="text-align:center;margin-top:6px">Support the Vision</a>
    </div>
  </div>
</header>

<main class="container">
  <h1 class="title">üåê The Mynd Multilayer Framework</h1>
  <p class="lead">One truth ‚Äî four worlds. Pick the lens that speaks your language. You can switch anytime.</p>

  <!-- LENS PICKER -->
  <div class="lens">
    <button class="chip" id="pick-garden" data-world="garden">üåø Garden <small>‚Äî intuitive</small></button>
    <button class="chip" id="pick-city" data-world="city">üåÜ City <small>‚Äî structural</small></button>
    <button class="chip" id="pick-forge" data-world="forge">üî• Forge <small>‚Äî transformational</small></button>
    <button class="chip" id="pick-system" data-world="system">üß† System <small>‚Äî analytical</small></button>
    <button class="save" id="saveLens" title="Save as my default lens">üíæ Save my lens</button>
  </div>

  <!-- WORLD CARDS PREVIEW -->
  <section class="worlds" aria-label="World previews">
    <article class="card"><span class="tag">üåø The Garden</span><h3>Emotional / Organic</h3>
      <div class="wash garden">
        <p><strong>Tone:</strong> poetic, natural, intuitive</p>
        <p><strong>Keywords:</strong> growth, tending, soil, roots, weather, light</p>
        <p><em>‚ÄúNotice which emotions you‚Äôve been watering lately.‚Äù</em></p>
      </div>
      <div class="block"><h4>Prompts</h4><ul>
        <li>What am I cultivating in my inner soil this week?</li>
        <li>Where does my garden feel dry or overgrown?</li>
        <li>What seed (new thought) do I want to plant today?</li>
      </ul></div>
    </article>
    <article class="card"><span class="tag">üåÜ The City</span><h3>Cognitive / Structural</h3>
      <div class="wash city">
        <p><strong>Tone:</strong> clear, modern, analytical</p>
        <p><strong>Keywords:</strong> architecture, blueprint, grid, system</p>
        <p><em>‚ÄúWhich mental neighborhoods have you neglected?‚Äù</em></p>
      </div>
      <div class="block"><h4>Prompts</h4><ul>
        <li>Which old buildings (beliefs) are ready for renovation?</li>
        <li>What new architecture (habits) do I want to design?</li>
        <li>When did the last power outage (depletion) occur ‚Äî and why?</li>
      </ul></div>
    </article>
    <article class="card"><span class="tag">üî• The Forge</span><h3>Transformational / Experiential</h3>
      <div class="wash forge">
        <p><strong>Tone:</strong> passionate, raw, motivating</p>
        <p><strong>Keywords:</strong> fire, pressure, metal, mastery</p>
        <p><em>‚ÄúEach trial is a hammer strike shaping your blade.‚Äù</em></p>
      </div>
      <div class="block"><h4>Prompts</h4><ul>
        <li>What recent fire is forging me stronger?</li>
        <li>What outdated identity am I melting away?</li>
        <li>Where do I need to temper intensity with rest?</li>
      </ul></div>
    </article>
    <article class="card"><span class="tag">üß† The System</span><h3>Analytical / Technical</h3>
      <div class="wash system">
        <p><strong>Tone:</strong> clear, efficient, scientific</p>
        <p><strong>Keywords:</strong> data, input, code, update, interface</p>
        <p><em>‚ÄúDebugging is awareness in action.‚Äù</em></p>
      </div>
      <div class="block"><h4>Prompts</h4><ul>
        <li>What recurring emotion points to a looping script?</li>
        <li>What old code (belief) can I comment out today?</li>
        <li>If my mind is software, what version am I running?</li>
      </ul></div>
    </article>
  </section>

  <div class="divider"></div>

  <!-- =================== CORE + INTERPRETIVE =================== -->
  <section class="panel">
    <div class="section">
      <h2 class="title" style="font-size:28px;margin:0 0 8px">ü™û Core Teaching Layer (shared)</h2>
      <div class="grid">
        <div class="block">
          <h4>Root Wisdom</h4>
          <ul>
            <li><strong>Emotions are energy in motion.</strong></li>
            <li><strong>Beliefs shape perception.</strong></li>
            <li><strong>Awareness brings integration.</strong></li>
          </ul>
          <p>These principles never change ‚Äî only the language around them does.</p>
        </div>
        <div class="block">
          <h4>How Mynd adapts</h4>
          <p>Your selected world becomes a <em>translation filter</em>. The teachings stay constant, while metaphors, tone, visuals and prompts shift to match your style.</p>
          <button class="btn save full-mobile" id="jumpPicker">Change lens</button>
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="title" style="font-size:28px;margin:10px 0 8px">üåê Interpretive Layer (same truth, four versions)</h2>
      <div class="block">
        <table class="table" aria-label="Interpretations of the same teaching">
          <thead>
            <tr><th>Archetype</th><th>Version of ‚ÄúAllow emotion to move through you‚Äù</th></tr>
          </thead>
          <tbody>
            <tr><td>üåø Garden</td><td>Let the river flow through your garden rather than damming it.</td></tr>
            <tr><td>üåÜ City</td><td>Restore power flow to the circuit ‚Äî don‚Äôt overload the grid.</td></tr>
            <tr><td>üî• Forge</td><td>Let the fire burn clean ‚Äî don‚Äôt trap the heat inside.</td></tr>
            <tr><td>üß† System</td><td>Allow the process to run ‚Äî emotion is data moving through the system.</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <div class="divider"></div>

  <!-- =================== CURRICULUM (GARDEN CONTENT, ADAPTED) =================== -->
  <section class="panel" id="curriculum">
    <h2 class="title" style="font-size:30px;margin:0 0 8px">üåø The Garden Curriculum (adapts to your world)</h2>
    <p class="lead">Eight modules distilled from your original Garden page ‚Äî expanded and simplified so ages 10‚Äì100 can learn. Each module includes: lesson, science, everyday examples, kid version, practices, and reflection. The wording below shifts with the lens you choose.</p>

    <!-- Modules inject here -->
    <div id="modules"></div>
  </section>

  <div class="divider"></div>
</main>

<footer>
  <div class="container footer-inner">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="logo" style="width:30px;height:30px;border-radius:10px;background:linear-gradient(160deg,#bbd7f5,#7fb68b);color:#0d1b10;display:grid;place-items:center;font-family:'Playfair Display',serif">My</div>
      <div><strong>Mynd</strong><div class="tiny">One truth ‚Äî four worlds.</div></div>
    </div>
    <div class="tiny">¬© <span id="year"></span> Mynd. All rights reserved.</div>
  </div>
</footer>

<script>
  // Year
  document.getElementById('year').textContent = new Date().getFullYear();

  // Mobile sheet
  const sheet = document.getElementById('sheet');
  const openBtn = document.querySelector('.menu-btn');
  const closeBtn = document.getElementById('closeSheet');
  const openSheet = () => { sheet.style.display='block'; sheet.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
  const closeSheetFn = () => { sheet.style.display='none'; sheet.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
  if(openBtn){ openBtn.addEventListener('click', openSheet) }
  if(closeBtn){ closeBtn.addEventListener('click', closeSheetFn) }
  if(sheet){ sheet.addEventListener('click', (e)=>{ if(e.target===sheet) closeSheetFn(); }); }

  // =================== MULTILAYER ENGINE ===================
  const LENS_KEY = 'mynd_world';
  const JOURNAL_KEY_PREFIX = 'mynd_journal_';
  const worldLabelMap = {garden:'Garden', city:'City', forge:'Forge', system:'System'};

  // Base curriculum: neutral truths (from your Garden page)
  // Each module has: id, title, core, science, examples[], table? (omitted for brevity), practices[], principles[], reflection, kid
  const baseModules = [
    {
      id:'attention', icon:'üë©‚Äçüåæ', title:'Attention (The Gardener)',
      core:[
        'Attention is the gardener of the mind. Where awareness goes, energy grows.',
        'If belief is soil and thought is seed, attention is the hand that waters, weeds, and directs light.'
      ],
      science:[
        'What fires together wires together ‚Äî repeated focus strengthens neural pathways.',
        'Autopilot is attention hijacked by stress/distraction; presence reclaims it.'
      ],
      examples:[
        'Relationship text: water curiosity instead of insecurity.',
        'Morning scroll scatters attention like watering every weed.',
        'Creative doubt deepens when fed; one small action waters growth.'
      ],
      practices:[
        '3-Minute Beam: rest attention on one sound or object.',
        'Attention Audit (evening): where did attention go ‚Äî did it feed or drain?',
        'Anchor: hand on heart + one deep breath ‚Üí ‚ÄúWhat am I growing right now?‚Äù'
      ],
      principles:[
        'Attention is a choice, not a reflex.',
        'What you resist, you water.',
        'Quality over quantity ‚Äî loving focus > long busyness.',
        'Presence restores power.'
      ],
      reflection:'‚ÄúAttention is the bridge between the unseen and the seen.‚Äù',
      kid:'Your focus is like a flashlight. Shine it on helpful things and they get bigger.'
    },
    {
      id:'belief', icon:'ü™¥', title:'Belief (The Soil)',
      core:[
        'Beliefs are invisible architecture setting what feels possible.',
        'Healthy soil (flexible belief) allows growth; compacted soil (rigidity) chokes it.'
      ],
      science:[
        'Beliefs form from early patterns and repeated emotion; they once kept you safe.',
        'Not every old belief serves who you‚Äôre becoming.'
      ],
      examples:[
        '‚ÄúPeople can‚Äôt be trusted‚Äù ‚Üí attention finds betrayal.',
        '‚ÄúLife supports my growth‚Äù ‚Üí you notice help and synchronicity.'
      ],
      practices:[
        'Root Excavation: ‚ÄúWhat must I believe to keep this pattern?‚Äù',
        'Compost Method: thank the protective belief ‚Üí update it.',
        'Rewriting Loop: choose an upgraded belief and collect proof for 7 days.'
      ],
      principles:['Curiosity aerates soil.','Diversity strengthens ecosystems.','Embodiment updates belief.','Nothing grows in shame.'],
      reflection:'‚ÄúYou don‚Äôt attract what you want ‚Äî you grow what you believe you can hold.‚Äù',
      kid:'Beliefs are like the dirt for your seeds. Good dirt helps ideas grow.'
    },
    {
      id:'thought', icon:'üå∞', title:'Thought (The Seed)',
      core:[
        'Thoughts are seeds; repeated + emotionalized thoughts sprout into habits and outcomes.',
        'Thought + belief + emotion ‚Üí germination.'
      ],
      science:[
        'Thoughts are electrical impulses; emotion adds chemical ‚Äúwater.‚Äù',
        'Repetition with feeling builds neural pathways.'
      ],
      examples:[
        'Mirror: ‚ÄúI look exhausted‚Äù seeds a low-energy day ‚Üí swap for ‚ÄúI‚Äôm restoring.‚Äù',
        'Work spiral: ‚ÄúI‚Äôm terrible‚Äù ‚Üí ‚ÄúI‚Äôm learning faster than before.‚Äù',
        'Late text: ‚ÄúThey‚Äôre ignoring me‚Äù ‚Üí ‚ÄúThey might be busy.‚Äù'
      ],
      practices:[
        'Thought Harvest: track thoughts before tension.',
        'Seed Substitution: write 3 truer, kinder alternatives.',
        'Morning Planting: choose 3 conscious thoughts before phone.'
      ],
      principles:['Observe before you weed.','Compost unhelpful thoughts.','Visualize to nourish imagination.','Use rhythm to stabilize.'],
      reflection:'‚ÄúThoughts are seeds ‚Äî belief is soil, emotion is rain.‚Äù',
      kid:'Your thoughts are tiny seeds; the ones you plant again grow into your day.'
    },
    {
      id:'emotion', icon:'üíß', title:'Emotion (The Water)',
      core:[
        'Emotion is energy in motion ‚Äî water of the inner ecosystem.',
        'Repressed = drought, overindulged = flood; flowing emotion nourishes.'
      ],
      science:[
        'Emotions are the body‚Äôs language; they shift hormones and perception.',
        'Unfelt feelings store as tension until acknowledged.'
      ],
      examples:[
        'Inbox flood: breathe, pick one priority.',
        'Argument: ‚ÄúI feel frustrated because I care‚Äù ‚Üí connection.',
        'Crying is rain ‚Äî let it fall; growth follows.'
      ],
      practices:[
        'Weather Report: ‚ÄúI feel __, intensity __/10, resisting/allowing?‚Äù',
        'Feel, Don‚Äôt Fix: locate sensation, lengthen exhale for 60s.',
        'Transmutation Journal: trigger ‚Üí belief ‚Üí need ‚Üí action.'
      ],
      principles:['Emotion = energy + permission.','Movement is medicine.','Feeling ‚â† identity.','All emotions teach.'],
      reflection:'‚ÄúEmotion is truth in motion.‚Äù',
      kid:'Feelings are like weather: notice them, don‚Äôt fight the rain.'
    },
    {
      id:'awareness', icon:'‚òÄÔ∏è', title:'Awareness (The Sun)',
      core:[
        'Awareness is clear seeing without judgment; it turns reaction into choice.',
        'The act of seeing clearly is itself transformation.'
      ],
      science:[
        'Meta-cognition: noticing thought, feeling, body.',
        'Awareness integrates attention, belief, thought, and emotion.'
      ],
      examples:[
        'Trigger: notice body + story ‚Üí choice returns.',
        'Spiral: ‚ÄúI‚Äôm avoiding rest‚Äù ‚Üí phone down.',
        'Creative block: ‚ÄúFear of being seen‚Äù ‚Üí knot loosens.'
      ],
      practices:[
        'Observer Meditation: label ‚Äúthinking/feeling/sensing.‚Äù',
        'Light on Shadows: breathe x3; ask which belief is here; imagine sunlight.',
        'Awareness Checkpoints: 3 daily reminders ‚Äî ‚Äú‚òÄÔ∏è Breathe and see.‚Äù'
      ],
      principles:['Seeing (not fixing) transforms.','You can‚Äôt heal what you won‚Äôt see.','Judgment clouds awareness.','Quiet reveals insight.'],
      reflection:'‚ÄúAwareness reveals true nature ‚Äî and that revelation is the change.‚Äù',
      kid:'Awareness is like turning on a light to see what‚Äôs in the room.'
    },
    {
      id:'self', icon:'üå≥', title:'Self (The Tree)',
      core:[
        'Self as tree: roots (past), trunk (identity), branches (choices), leaves/fruit (results).',
        'Healthy identity = strong roots + flexible branches.'
      ],
      science:['Narrative identity meets observer consciousness.','Boundaries are like bark ‚Äî they protect growth.'],
      examples:[
        'Pruning old roles gives room for new growth.',
        'Rotten fruit (bad outcomes) traces back to soil and gardener.'
      ],
      practices:[
        'Map Your Tree: roots/values/branches/fruit.',
        'Trunk Alignment: name 3 ‚ÄúI am‚Äù values; act on one today.',
        'Pruning Ritual: release one role or task that no longer fits.'
      ],
      principles:['Roots before fruit.','Pruning grows life.','Storms strengthen.','Fruit feeds the forest.'],
      reflection:'‚ÄúYou are the meeting point of heaven and earth.‚Äù',
      kid:'You are like a tree: your choices are branches; your wins are the fruit.'
    },
    {
      id:'cycles', icon:'üçÇ', title:'Cycles (The Seasons)',
      core:[
        'Seasons are rhythms of transformation; resisting a season creates suffering.',
        'Wise gardeners don‚Äôt demand summer in winter.'
      ],
      science:[
        'Cycle: Spring (start) ‚Üí Summer (build) ‚Üí Autumn (integrate) ‚Üí Winter (rest).',
        'Rest creates clarity; decay feeds new growth.'
      ],
      examples:[
        'Creativity winter: rest and collect ideas.',
        'Business cycles: ideate, build, launch, reflect.'
      ],
      practices:[
        'Seasonal Mapping: label your current inner season.',
        'Ritual of Renewal: choose one rest practice.',
        'Sacred Pause Day (weekly): recovery for nervous system.'
      ],
      principles:['Rest is productive.','Let endings complete.','No skipping seasons.','Honor your rhythm.'],
      reflection:'‚ÄúLife doesn‚Äôt move in straight lines ‚Äî it breathes in circles.‚Äù',
      kid:'Like the year, you have seasons: time to start, grow, harvest, and rest.'
    },
    {
      id:'challenges', icon:'‚õàÔ∏è', title:'Challenges (The Storms)',
      core:[
        'Storms refine what‚Äôs meant to stand: they clarify values and strengthen roots.',
        'Preparation is compassion for future you.'
      ],
      science:['Stress narrows focus; grounding widens choices.','After-storm learning prevents repeat damage.'],
      examples:[
        'Boundary storm: make one clear, kind request.',
        'Overwhelm squall: prune tasks, ground body first.'
      ],
      practices:[
        'Storm Card: Name ‚Üí Breathe (exhale 6s) ‚Üí Boundary (one ask) ‚Üí Ask (support).',
        'After-Action Reflection: What skill did the storm offer?'
      ],
      principles:['Ground first, act second.','Every storm carries a seed of skill.','Small actions change big weather.'],
      reflection:'‚ÄúWind strengthens what is meant to stand.‚Äù',
      kid:'Storms help trees grow stronger; tough moments help you grow too.'
    }
  ];

  // Per-world translators: swap metaphors & phrasing while keeping principles
  const translators = {
    garden: {
      wrap:(t)=>t,
      metaphors:{
        attention:['gardener','water','sunlight'],
        belief:['soil','roots','bed'],
        thought:['seed','sprout','plant'],
        emotion:['river','rain','flow'],
        awareness:['sun','light','clarity'],
        self:['tree','branches','fruit'],
        cycles:['seasons','spring/summer/autumn/winter','rhythm'],
        challenges:['storms','wind','shelter']
      },
      toneHint:'Use imagery and gentle guidance.'
    },
    city: {
      wrap:(t)=>t
        .replaceAll('garden','city').replaceAll('Garden','City')
        .replaceAll('soil','foundation').replaceAll('seed','blueprint')
        .replaceAll('river','power grid').replaceAll('sun','signal'),
      metaphors:{
        attention:['architect','power','signal'],
        belief:['foundation','zoning','load-bearing'],
        thought:['blueprint','module','build'],
        emotion:['power grid','current','bandwidth'],
        awareness:['signal','diagnostic','telemetry'],
        self:['city','districts','landmarks'],
        cycles:['phases','plan/build/ship/retro','cadence'],
        challenges:['outages','load spikes','failover']
      },
      toneHint:'Be clear, modern, and structured.'
    },
    forge: {
      wrap:(t)=>t
        .replaceAll('garden','forge').replaceAll('soil','crucible').replaceAll('seed','ingot')
        .replaceAll('river','flame').replaceAll('sun','temper'),
      metaphors:{
        attention:['smith','heat','hammer'],
        belief:['crucible','alloy','temper'],
        thought:['ingot','blade','metal'],
        emotion:['flame','heat','bellows'],
        awareness:['temper','quench','clarity'],
        self:['blade','edge','craft'],
        cycles:['fires','heat/work/quench/hone','ritual'],
        challenges:['trials','pressure','anvil']
      },
      toneHint:'Be passionate, direct, and courageous.'
    },
    system: {
      wrap:(t)=>t
        .replaceAll('garden','system').replaceAll('soil','memory').replaceAll('seed','script')
        .replaceAll('river','process').replaceAll('sun','runtime'),
      metaphors:{
        attention:['process scheduler','CPU time','thread'],
        belief:['defaults','config','constraints'],
        thought:['script','program','module'],
        emotion:['output','signal','throughput'],
        awareness:['debugger','logger','visibility'],
        self:['stack','interfaces','outputs'],
        cycles:['versions','plan/build/release/maintain','sprints'],
        challenges:['exceptions','latency','fallback']
      },
      toneHint:'Be precise, minimal, and testable.'
    }
  };

  // Render curriculum with world-specific phrasing + kid/advanced tracks
  const modulesRoot = document.getElementById('modules');

  function toList(items){ return `<ul>${items.map(x=>`<li>${x}</li>`).join('')}</ul>`; }

  function renderModule(mod, world){
    const t = translators[world];
    // Title & small substitutions per world
    const titleWrapped = t.wrap(mod.title);
    const core = t.wrap(mod.core.join(' '));
    const science = t.wrap(mod.science.join(' '));
    const examples = mod.examples.map(t.wrap);
    const practices = mod.practices.map(t.wrap);
    const principles = mod.principles.map(t.wrap);
    const reflection = t.wrap(mod.reflection);
    const kid = t.wrap(mod.kid);

    const journalKey = JOURNAL_KEY_PREFIX + world + '_' + mod.id;
    const saved = localStorage.getItem(journalKey) || '';

    return `
      <section class="module block" id="${mod.id}">
        <div class="module-header">
          <h3 style="margin:0">${mod.icon} ${titleWrapped}</h3>
          <span class="badge">Module</span>
        </div>

        <div class="block" style="margin-top:12px;background:var(--cat-lesson-bg)"><h4 style="color:var(--cat-lesson-h)">Core Teaching</h4><p>${core}</p></div>
        <div class="block" style="background:var(--cat-science-bg)"><h4 style="color:var(--cat-science-h)">Science & Psychology</h4><p>${science}</p></div>
        <div class="kid"><strong>Kid version:</strong> ${kid}</div>

        <div class="block" style="background:var(--cat-story-bg)"><h4 style="color:var(--cat-story-h)">Everyday Examples</h4>${toList(examples)}</div>
        <div class="block" style="background:var(--cat-practice-bg)"><h4 style="color:var(--cat-practice-h)">Try This</h4>${toList(practices)}</div>
        <div class="block" style="background:var(--cat-note-bg)"><h4 style="color:var(--cat-note-h)">Principles</h4>${toList(principles)}</div>
        <div class="mantra"><em>${reflection}</em></div>

        <div class="block journal">
          <h4>Journal ‚Äî your notes for ${titleWrapped}</h4>
          <textarea data-key="${journalKey}" placeholder="Write freely‚Ä¶">${saved}</textarea>
          <button class="btn primary full-mobile" data-clear="${journalKey}">Clear this journal</button>
        </div>
      </section>
    `;
  }

  function renderAll(world){
    modulesRoot.innerHTML = baseModules.map(m=>renderModule(m, world)).join('');
    // Wire up journals
    modulesRoot.querySelectorAll('textarea').forEach(el=>{
      el.addEventListener('input', ()=> localStorage.setItem(el.dataset.key, el.value));
    });
    modulesRoot.querySelectorAll('button[data-clear]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const key = btn.dataset.clear;
        localStorage.removeItem(key);
        const ta = modulesRoot.querySelector(`textarea[data-key="${key}"]`);
        if(ta) ta.value = '';
      });
    });
    // Update document title to match lens
    document.title = `Mynd ‚Ä¢ ${worldLabelMap[world]} Curriculum`;
  }

  // Lens selection + persistence
  function setLens(world){
    const w = ['garden','city','forge','system'].includes(world) ? world : 'garden';
    localStorage.setItem(LENS_KEY, w);
    renderAll(w);
  }

  document.getElementById('pick-garden').addEventListener('click', ()=> setLens('garden'));
  document.getElementById('pick-city').addEventListener('click', ()=> setLens('city'));
  document.getElementById('pick-forge').addEventListener('click', ()=> setLens('forge'));
  document.getElementById('pick-system').addEventListener('click', ()=> setLens('system'));
  document.getElementById('saveLens').addEventListener('click', (e)=>{
    const w = localStorage.getItem(LENS_KEY) || 'garden';
    e.currentTarget.textContent = '‚úÖ Lens saved';
    setTimeout(()=>{ e.currentTarget.textContent = 'üíæ Save my lens'; }, 1400);
    // noop: already persisted on setLens
  });
  document.getElementById('jumpPicker').addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));

  // Initialize with saved lens
  setLens(localStorage.getItem(LENS_KEY) || 'garden');
</script>
</body>
</html>
